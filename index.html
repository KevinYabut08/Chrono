<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chrono ¬∑ timeline journal</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Puter.js - Free AI Integration -->
    <script src="https://js.puter.com/v2/"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Auth Page -->
    <div class="auth-page" id="authPage">
        <div class="auth-card">
            <div class="auth-header">
                <div class="logo">
                    <i class="fas fa-timeline"></i>
                    chrono
                </div>
                <p>your timeline journal</p>
            </div>

            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchAuthTab('login')">sign in</button>
                <button class="auth-tab" onclick="switchAuthTab('register')">sign up</button>
            </div>

            <!-- Login Form -->
            <div class="auth-form active" id="loginForm">
                <div class="form-group">
                    <label>email</label>
                    <input type="email" id="loginEmail" placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label>password</label>
                    <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <div class="error-message" id="loginError"></div>
                <button class="btn" onclick="loginWithEmail()">
                    <i class="fas fa-arrow-right"></i>
                    sign in
                </button>
                
                <!-- <div class="divider">
                    <span>or</span>
                </div>
                
                <button class="btn btn-google" onclick="loginWithGoogle()">
                    <i class="fab fa-google"></i>
                    continue with google
                </button> -->
            </div>

            <!-- Register Form -->
            <div class="auth-form" id="registerForm">
                <div class="form-group">
                    <label>name</label>
                    <input type="text" id="registerName" placeholder="your name">
                </div>
                <div class="form-group">
                    <label>email</label>
                    <input type="email" id="registerEmail" placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label>password</label>
                    <input type="password" id="registerPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <div class="error-message" id="registerError"></div>
                <button class="btn" onclick="registerWithEmail()">
                    <i class="fas fa-user-plus"></i>
                    create account
                </button>
                
                <!-- <div class="divider">
                    <span>or</span>
                </div>
                
                <button class="btn btn-google" onclick="loginWithGoogle()">
                    <i class="fab fa-google"></i>
                    continue with google
                </button> -->
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div class="main-app" id="mainApp">
        <!-- Top Navigation -->
        <nav class="top-nav">
            <div class="nav-container">
                <div class="nav-left">
                    <div class="logo" onclick="switchPage('timeline')">
                        <i class="fas fa-timeline"></i>
                        chrono
                    </div>
                    <div class="nav-links">
                        <div class="nav-link active" onclick="switchPage('timeline')">
                            <i class="fas fa-stream"></i>
                            timeline
                        </div>
                        <div class="nav-link" onclick="switchPage('universes')">
                            <i class="fas fa-globe"></i>
                            universes
                        </div>
                        <div class="nav-link" onclick="switchPage('capsules')">
                            <i class="fas fa-hourglass"></i>
                            capsules
                        </div>
                    </div>
                </div>
                <div class="nav-right">
                    <!-- Theme Toggle -->
                    <div class="theme-toggle-container">
                        <div class="theme-toggle">
                            <button class="theme-btn active" onclick="setTheme('light')">
                                <i class="fas fa-sun"></i>
                            </button>
                            <button class="theme-btn" onclick="setTheme('dark')">
                                <i class="fas fa-moon"></i>
                            </button>
                        </div>
                    </div>
                    <div class="user-profile" onclick="switchPage('profile')">
                        <span class="user-name" id="navName">Loading...</span>
                        <div class="user-avatar" id="navAvatar">...</div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- AI Status Indicator -->
        <div class="ai-status" id="aiStatus">
            <i class="fas fa-robot" style="color: #2563eb;"></i>
            <span>AI <span id="aiStatusText">checking...</span></span>
        </div>

        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Left Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-title">
                        <i class="fas fa-user"></i>
                        your timeline
                    </div>
                    <div class="menu-item active" onclick="switchPage('timeline')">
                        <i class="fas fa-stream"></i>
                        <span>main timeline</span>
                    </div>
                    <div class="menu-item" onclick="switchPage('alternate')">
                        <i class="fas fa-code-branch"></i>
                        <span>alternate paths</span>
                    </div>
                    <div class="menu-item" onclick="switchPage('memories')">
                        <i class="fas fa-clock"></i>
                        <span>memories</span>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">
                        <i class="fas fa-chart-line"></i>
                        stats
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">events</span>
                        <span class="stat-value" id="statEvents">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">universes</span>
                        <span class="stat-value" id="statUniverses">4</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">capsules</span>
                        <span class="stat-value" id="statCapsules">0</span>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Timeline Page -->
                <div class="page active" id="timelinePage">
                    <div class="page-header">
                        <h2>your timeline</h2>
                        <p>important moments across your life</p>
                    </div>

                    <div class="timeline-container">
                        <div class="timeline-line"></div>
                        <div class="timeline-events" id="timelineEvents">
                            <!-- Events will be inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Alternate Paths Page -->
                <div class="page" id="alternatePage">
                    <div class="page-header">
                        <h2>alternate paths</h2>
                        <p>different versions of your timeline</p>
                    </div>

                    <div class="timeline-events" id="alternateEvents">
                        <!-- Alternate events will be inserted here -->
                    </div>
                </div>

                <!-- Memories Page -->
                <div class="page" id="memoriesPage">
                    <div class="page-header">
                        <h2>memories</h2>
                        <p>past moments to cherish</p>
                    </div>

                    <div class="cards-grid" id="memoriesGrid">
                        <!-- Memories will be inserted here -->
                    </div>
                </div>

                <!-- Universes Page -->
                <div class="page" id="universesPage">
                    <div class="page-header">
                        <h2>parallel universes</h2>
                        <p>alternate versions of reality</p>
                    </div>

                    <div class="cards-grid" id="universesGrid">
                        <!-- Universes will be inserted here -->
                    </div>
                </div>

                <!-- Capsules Page -->
                <div class="page" id="capsulesPage">
                    <div class="page-header">
                        <h2>time capsules</h2>
                        <p>messages to your future self</p>
                    </div>

                    <div class="cards-grid" id="capsulesGrid">
                        <!-- Capsules will be inserted here -->
                    </div>
                </div>

                <!-- Profile Page -->
                <div class="page" id="profilePage">
                    <div class="page-header">
                        <h2>your profile</h2>
                        <p>manage your account</p>
                    </div>

                    <div class="event-card">
                        <div class="profile-header">
                            <div class="profile-avatar-large" id="profileAvatar">A</div>
                            <div class="profile-info">
                                <h3 id="profileName">Loading...</h3>
                                <p class="profile-email" id="profileEmail">loading...</p>
                                <p class="profile-member">member since <span id="profileDate">2024</span></p>
                            </div>
                        </div>

                        <div class="profile-stats-grid">
                            <div class="profile-stat-card">
                                <div class="profile-stat-value" id="profileEvents">0</div>
                                <div class="profile-stat-label">events</div>
                            </div>
                            <div class="profile-stat-card">
                                <div class="profile-stat-value" id="profileUniverses">4</div>
                                <div class="profile-stat-label">universes</div>
                            </div>
                            <div class="profile-stat-card">
                                <div class="profile-stat-value" id="profileCapsules">0</div>
                                <div class="profile-stat-label">capsules</div>
                            </div>
                        </div>

                        <button class="btn btn-danger" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i>
                            sign out
                        </button>
                    </div>
                </div>

                <!-- Loading Spinner -->
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>loading your timeline...</p>
                </div>
            </main>

            <!-- Right Sidebar -->
            <aside class="right-sidebar">
                <div class="widget">
                    <div class="widget-header">
                        <h4>quick stats</h4>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">total events</span>
                        <span class="stat-value" id="quickStatsEvents">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">past events</span>
                        <span class="stat-value" id="quickStatsPast">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">future goals</span>
                        <span class="stat-value" id="quickStatsFuture">0</span>
                    </div>
                </div>

                <div class="widget">
                    <div class="widget-header">
                        <h4>quick tips</h4>
                    </div>
                    <ul class="tips-list">
                        <li>‚Ä¢ click + to add events</li>
                        <li>‚Ä¢ explore alternate timelines</li>
                        <li>‚Ä¢ create time capsules</li>
                        <li>‚Ä¢ toggle theme in top right</li>
                        <li>‚Ä¢ AI generates descriptions</li>
                    </ul>
                </div>
            </aside>
        </div>

        <!-- Floating Action Button -->
        <div class="fab-container">
            <div class="fab-options" id="fabOptions">
                <div class="fab-option" onclick="openCreateModal(); toggleFabMenu()">
                    <i class="fas fa-stream" style="color: var(--primary);"></i>
                    <span>add timeline event</span>
                </div>
                <div class="fab-option" onclick="openCapsuleModal(); toggleFabMenu()">
                    <i class="fas fa-hourglass" style="color: var(--secondary);"></i>
                    <span>create time capsule</span>
                </div>
            </div>
            <div class="fab" onclick="toggleFabMenu()">
                <i class="fas fa-plus" id="fabIcon"></i>
            </div>
        </div>

        <!-- Create Event Modal (WITH AI BUTTON) -->
        <div class="modal" id="createModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>add timeline event</h3>
                    <i class="fas fa-times close-btn" onclick="closeCreateModal()"></i>
                </div>

                <div class="form-group">
                    <label>title</label>
                    <div style="display: flex; gap: 0.5rem;">
                        <input type="text" id="eventTitle" placeholder="what happened?" style="flex: 1;">
                        <button type="button" class="btn btn-ai" onclick="showAISuggestions()" style="width: auto; padding: 0.875rem 1.5rem; background: var(--primary);" title="Get AI suggestions">
                            <i class="fas fa-magic"></i>
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label>description</label>
                    <textarea id="eventDescription" placeholder="describe the moment... (AI will generate if empty)"></textarea>
                </div>

                <div class="form-group">
                    <label>year</label>
                    <input type="number" id="eventYear" placeholder="2024" value="2024">
                </div>

                <div class="form-group">
                    <label>dimension</label>
                    <div class="dimension-selector">
                        <div class="dimension-option selected" onclick="selectEventDimension('past', this)">
                            <i class="fas fa-history"></i>
                            past
                        </div>
                        <div class="dimension-option" onclick="selectEventDimension('present', this)">
                            <i class="fas fa-clock"></i>
                            present
                        </div>
                        <div class="dimension-option" onclick="selectEventDimension('future', this)">
                            <i class="fas fa-rocket"></i>
                            future
                        </div>
                    </div>
                </div>

                <button class="btn" onclick="createTimelineEvent()">
                    <i class="fas fa-plus"></i>
                    add to timeline
                </button>
            </div>
        </div>

        <!-- Create Capsule Modal (with fixed button ID) -->
        <div class="modal" id="createCapsuleModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>create time capsule</h3>
                    <i class="fas fa-times close-btn" onclick="closeCapsuleModal()"></i>
                </div>

                <div class="form-group">
                    <label>üì® message to future self</label>
                    <textarea id="capsuleMessage" placeholder="what would you tell future you?" rows="4" style="width: 100%; padding: 1rem; background: var(--surface-light); border: 1px solid var(--border); border-radius: var(--radius-md); color: var(--text);"></textarea>
                </div>

                <div class="form-group">
                    <label>‚è≥ open in (years)</label>
                    <input type="number" id="capsuleYears" placeholder="10" value="10" min="1" max="100" style="width: 100%; padding: 1rem; background: var(--surface-light); border: 1px solid var(--border); border-radius: var(--radius-md); color: var(--text);">
                </div>

                <div style="display: flex; gap: 0.5rem;">
                    <button class="btn" onclick="createCapsule()" style="flex: 2;">
                        <i class="fas fa-hourglass"></i>
                        seal capsule
                    </button>
                    <button class="btn" id="enhanceAIBtn" onclick="enhanceCapsuleMessageWithAI()" style="flex: 1; background: var(--secondary);" title="Enhance with AI">
                        <i class="fas fa-magic"></i>
                        enhance
                    </button>
                </div>
                
                <p style="color: var(--text-tertiary); font-size: 0.8rem; margin-top: 1rem; text-align: center;">
                    ‚ú® AI can make your message more meaningful
                </p>
            </div>
        </div>

                <!-- Memory Detail Modal -->
        <div class="modal" id="memoryDetailModal">
            <div class="modal-content memory-detail-content">
                <div class="modal-header">
                    <h3 id="memoryDetailTitle">Memory</h3>
                    <i class="fas fa-times close-btn" onclick="closeMemoryModal()"></i>
                </div>
                
                <div class="memory-detail-body">
                    <div class="memory-detail-year" id="memoryDetailYear">
                        <i class="fas fa-calendar"></i>
                        <span>2024</span>
                    </div>
                    
                    <div class="memory-detail-description" id="memoryDetailDescription">
                        Loading...
                    </div>
                    
                    <div class="memory-detail-meta">
                        <div class="memory-dimension">
                            <i class="fas fa-history"></i>
                            <span>Past Event</span>
                        </div>
                        <div class="memory-created">
                            <i class="fas fa-clock"></i>
                            <span id="memoryDetailCreated">Just now</span>
                        </div>
                    </div>
                    
                    <div class="memory-detail-actions">
                        <button class="btn" onclick="exploreFromMemory()" id="memoryExploreBtn">
                            <i class="fas fa-code-branch"></i>
                            explore this memory
                        </button>
                        <button class="btn btn-danger" onclick="deleteMemory()" id="memoryDeleteBtn">
                            <i class="fas fa-trash"></i>
                            delete
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast Notification -->
        <div class="toast" id="toast">
            <i class="fas fa-check-circle"></i>
            <span id="toastMessage">timeline updated</span>
        </div>
    </div>

    <!-- Custom JavaScript -->
    <script src="script.js"></script>
</body>
</html>